<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>RSBID_Introduction</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">RSBID_Introduction</h1>



<p>The <strong>RSBID</strong> (short for Resampling Strategies for
Binary Imbalanced Dadasets) package contains functions of resampling
strategies to make the binary imbalanced datasets be more balanced. It
is important for an imbalanced dataset before applying a classification
algorithm, for the reason that class imbalance will lead to a bad
performance of classifiers.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RSBID)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare for the display of classification performance </span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>display <span class="ot">&lt;-</span> <span class="cf">function</span>(prediction, reference, positiveclass) {</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    cm <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">confusionMatrix</span>(<span class="at">data=</span>prediction, <span class="at">reference=</span>reference,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">mode =</span> <span class="st">&quot;sens_spec&quot;</span>, <span class="at">positive=</span>positiveclass)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(cm<span class="sc">$</span>table)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(<span class="at">Accuracy=</span>cm<span class="sc">$</span>overall[<span class="dv">1</span>], <span class="at">Sensitivity=</span>cm<span class="sc">$</span>byClass[<span class="dv">1</span>], <span class="at">Specificity=</span>cm<span class="sc">$</span>byClass[<span class="dv">2</span>],</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">row.names=</span><span class="cn">NULL</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div id="data-import" class="section level2">
<h2>1 Data Import</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(abalone)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>abalone<span class="sc">$</span>Class <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">gsub</span>(<span class="st">&quot; &quot;</span>, <span class="st">&quot;&quot;</span>, abalone<span class="sc">$</span>Class))</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(abalone)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;data.frame&#39;:    731 obs. of  8 variables:</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ Length        : num  0.53 0.475 0.45 0.55 0.665 0.355 0.45 0.47 0.525 0.505 ...</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ Diameter      : num  0.42 0.37 0.32 0.415 0.525 0.29 0.335 0.37 0.425 0.405 ...</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ Height        : num  0.135 0.125 0.1 0.135 0.165 0.09 0.105 0.12 0.16 0.11 ...</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ Whole_weight  : num  0.677 0.509 0.381 0.763 1.338 ...</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ Shucked_weight: num  0.257 0.216 0.171 0.318 0.551 ...</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ Viscera_weight: num  0.141 0.112 0.075 0.21 0.357 ...</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ Shell_weight  : num  0.21 0.165 0.115 0.2 0.35 0.09 0.115 0.14 0.245 0.175 ...</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ Class         : Factor w/ 2 levels &quot;negative&quot;,&quot;positive&quot;: 1 1 1 1 2 1 1 1 1 1 ...</span></span></code></pre></div>
<p>The <em>abalone</em> dataset is available in the
<strong>RSBID</strong> package. It has 731 observations and 8 variables.
In the outcome <em>Class</em>, the possitive examples belong to class 18
and the negative examples belong to class 9. We would like to find the
difference between these two kinds of abalone. Therefore, a good
performance of a classifier to classify them correctly is expected.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(abalone<span class="sc">$</span>Class)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; negative positive </span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      689       42</span></span></code></pre></div>
<p>As we can see, there are 689 negative examples and 42 positive
examples. The imbalanced ratio (IR) is about 16.4.</p>
</div>
<div id="model-building-for-a-imbalanced-dataset" class="section level2">
<h2>2 Model Building for a Imbalanced Dataset</h2>
<p>First of all, we need to separate this dataset into a training set
and a testing set. 0.7 would be used as the cutoff.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2019</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>inTrain <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">createDataPartition</span>(abalone<span class="sc">$</span>Class, <span class="at">p =</span> <span class="fl">0.7</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>abalone_train <span class="ot">&lt;-</span> abalone[inTrain, ]</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>abalone_test <span class="ot">&lt;-</span> abalone[<span class="sc">-</span>inTrain, ]</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(abalone_train<span class="sc">$</span>Class)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; negative positive </span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      483       30</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(abalone_test<span class="sc">$</span>Class)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; negative positive </span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      206       12</span></span></code></pre></div>
<p>The training set and the testing set are both imbalanced.</p>
<p>Now we apply Random Forests on this imbalanced dataset to check the
classification performance.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2019</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>fit_orig <span class="ot">&lt;-</span> randomForest<span class="sc">::</span><span class="fu">randomForest</span>(Class <span class="sc">~</span> ., <span class="at">data =</span> abalone_train)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>pred_class <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_orig, abalone_test, <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>(perf_orig <span class="ot">&lt;-</span> <span class="fu">display</span>(pred_class, abalone_test<span class="sc">$</span>Class, <span class="st">&quot;positive&quot;</span>))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           Reference</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Prediction negative positive</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   negative      206       11</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   positive        0        1</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Accuracy Sensitivity Specificity</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 0.9495413  0.08333333           1</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(perf_orig, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Accuracy</th>
<th align="right">Sensitivity</th>
<th align="right">Specificity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.9495413</td>
<td align="right">0.0833333</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>According to the result, the accuracy of this model is actually very
high. But all positive examples (i.e., the minority samples) were
classified incorrectly so that sensitivity is 0. This performance is
very bad actually.</p>
</div>
<div id="model-building-for-a-balanced-dataset" class="section level2">
<h2>3 Model Building for a Balanced Dataset</h2>
<p>Now we used the Under-Sampling Based on Clustering (SBC) algorithm as
an example to balance the dataset.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2019</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>train_sbc <span class="ot">&lt;-</span> <span class="fu">SBC</span>(abalone_train, <span class="st">&quot;Class&quot;</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(train_sbc<span class="sc">$</span>Class)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; negative positive </span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       30       30</span></span></code></pre></div>
<p>The dataset has been balanced now. Then build a new Random Forest
model for this balanced dataset.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2019</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>fit_orig <span class="ot">&lt;-</span> randomForest<span class="sc">::</span><span class="fu">randomForest</span>(Class <span class="sc">~</span> ., <span class="at">data =</span> train_sbc)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>pred_class <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_orig, abalone_test, <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>perf_sbc <span class="ot">&lt;-</span> <span class="fu">display</span>(pred_class, abalone_test<span class="sc">$</span>Class, <span class="st">&quot;positive&quot;</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           Reference</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Prediction negative positive</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   negative      150        4</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   positive       56        8</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(perf_sbc, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Accuracy</th>
<th align="right">Sensitivity</th>
<th align="right">Specificity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.7247706</td>
<td align="right">0.6666667</td>
<td align="right">0.7281553</td>
</tr>
</tbody>
</table>
<p>This time the classifier greatly predict most of the minority samples
in testing set, so the sensitivity is 0.6667. In the mean time, the
specificity is 0.7282, which means this classifier can also correctly
classify most of the majority samples. The improvement of performance is
significant!</p>
</div>
<div id="comparison-among-four-resampling-strategies" class="section level2">
<h2>4 Comparison among Four Resampling Strategies</h2>
<p>The <strong>RSBID</strong> package provides several resampling
strategies: random over-sampling algorithm (ROS), random under-sampling
algorithm (RUS), under-sampling based on clustering algorithm (SBC), and
synthetic minority over-sampling technique (SMOTE) and synthetic
minority over-sampling technique-Nominal Continuous (SMOTE-NC). For the
reason that <em>abalone</em> is a dataset that its all predictors are
continuous, ROS, RUS, SBC and SMOTE could be used to balance it.</p>
<p>The classification performance of Random Forests on four balanced
datasets by respectively using these four strategies would be shown
below.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2019</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>train_ros <span class="ot">&lt;-</span> <span class="fu">ROS</span>(abalone_train, <span class="st">&quot;Class&quot;</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>train_rus <span class="ot">&lt;-</span> <span class="fu">RUS</span>(abalone_train, <span class="st">&quot;Class&quot;</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>train_smote <span class="ot">&lt;-</span> <span class="fu">SMOTE</span>(abalone_train, <span class="st">&quot;Class&quot;</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>fit_ros <span class="ot">&lt;-</span> randomForest<span class="sc">::</span><span class="fu">randomForest</span>(Class <span class="sc">~</span> ., <span class="at">data=</span>train_ros)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>fit_rus <span class="ot">&lt;-</span> randomForest<span class="sc">::</span><span class="fu">randomForest</span>(Class <span class="sc">~</span> ., <span class="at">data=</span>train_rus)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>fit_smote <span class="ot">&lt;-</span> randomForest<span class="sc">::</span><span class="fu">randomForest</span>(Class <span class="sc">~</span> ., <span class="at">data=</span>train_smote)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>pred_class_ros <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_ros, abalone_test, <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>perf_ros <span class="ot">&lt;-</span> <span class="fu">display</span>(pred_class_ros, abalone_test<span class="sc">$</span>Class, <span class="st">&quot;positive&quot;</span>)  </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           Reference</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Prediction negative positive</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   negative      204        9</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   positive        2        3</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>pred_class_rus <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_rus, abalone_test, <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>perf_rus <span class="ot">&lt;-</span> <span class="fu">display</span>(pred_class_rus, abalone_test<span class="sc">$</span>Class, <span class="st">&quot;positive&quot;</span>)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           Reference</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Prediction negative positive</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   negative      142        2</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   positive       64       10</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>pred_class_smote <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_smote, abalone_test, <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>perf_smote <span class="ot">&lt;-</span> <span class="fu">display</span>(pred_class_smote, abalone_test<span class="sc">$</span>Class, <span class="st">&quot;positive&quot;</span>)</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           Reference</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Prediction negative positive</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   negative      198        8</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   positive        8        4</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">rbind</span>(perf_orig, perf_ros, perf_rus, perf_sbc, perf_smote)</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(output) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Imbalanced&quot;</span>, <span class="st">&quot;Balanced by ROS&quot;</span>, <span class="st">&quot;Balanced by RUS&quot;</span>,</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;Balanced by SBC&quot;</span>, <span class="st">&quot;Balanced by SMOTE&quot;</span>)</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(output)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Accuracy</th>
<th align="right">Sensitivity</th>
<th align="right">Specificity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Imbalanced</td>
<td align="right">0.9495413</td>
<td align="right">0.0833333</td>
<td align="right">1.0000000</td>
</tr>
<tr class="even">
<td align="left">Balanced by ROS</td>
<td align="right">0.9495413</td>
<td align="right">0.2500000</td>
<td align="right">0.9902913</td>
</tr>
<tr class="odd">
<td align="left">Balanced by RUS</td>
<td align="right">0.6972477</td>
<td align="right">0.8333333</td>
<td align="right">0.6893204</td>
</tr>
<tr class="even">
<td align="left">Balanced by SBC</td>
<td align="right">0.7247706</td>
<td align="right">0.6666667</td>
<td align="right">0.7281553</td>
</tr>
<tr class="odd">
<td align="left">Balanced by SMOTE</td>
<td align="right">0.9266055</td>
<td align="right">0.3333333</td>
<td align="right">0.9611650</td>
</tr>
</tbody>
</table>
<p>As we can see, all of these four algorithms helped to improve the
performance of random forest more or less. On the premise of ensuring a
good accuracy of a classifier, the sensitivity, which is highly related
to the minority class that we are more concerned, is improved by our
resampling strategies.</p>
</div>
<div id="another-quick-example" class="section level2">
<h2>5 Another Quick Example</h2>
<p><strong>RSBID</strong> provides another dataset named <em>bank</em>
with continuous and categorical predictors.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(bank)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(bank)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;data.frame&#39;:    904 obs. of  11 variables:</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ age      : int  35 59 36 37 41 56 59 42 26 32 ...</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ marital  : Factor w/ 3 levels &quot;divorced&quot;,&quot;married&quot;,..: 3 2 2 3 2 2 2 1 2 3 ...</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ education: Factor w/ 4 levels &quot;primary&quot;,&quot;secondary&quot;,..: 3 2 3 3 3 2 2 2 1 1 ...</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ balance  : int  1350 0 1109 2317 5883 784 42 1811 0 -849 ...</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ housing  : Factor w/ 2 levels &quot;no&quot;,&quot;yes&quot;: 2 2 1 2 1 1 1 2 2 2 ...</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ day      : int  16 5 13 20 20 30 21 14 21 4 ...</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ duration : int  185 226 328 114 182 149 40 150 425 204 ...</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ campaign : int  1 1 2 1 2 2 1 1 1 1 ...</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ pdays    : num  330 999 999 152 999 999 999 999 999 999 ...</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ previous : int  1 0 0 2 0 0 0 0 0 0 ...</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ deposit  : Factor w/ 2 levels &quot;no&quot;,&quot;yes&quot;: 1 1 1 1 1 1 1 1 1 1 ...</span></span></code></pre></div>
<p>The <em>bank</em> dataset has 904 observations and 11 variables. The
data is related with direct marketing campaigns of a Portuguese banking
institution. Except the outcome <em>deposit</em>, there are 3
categorical predictors and 7 continuous predictors.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(bank<span class="sc">$</span>deposit)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  no yes </span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 800 104</span></span></code></pre></div>
<p>In the outcome <em>deposit</em>, “yes” means that the clients have
subscribed a term deposit while “no” means that the clients have not
subscribed a term deposit. There are 800 “no” examples and 104 “yes”
examples. The imbalanced ratio (IR) is about 7.69.</p>
<p>We would like to find the difference between these two kinds of
desired targets. Therefore, a good performance of a classifier to
classify them correctly is expected.</p>
<p>First of all, we need to separate this dataset into a training set
and a testing set. 0.7 would be used as the cutoff.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2019</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>inTrain <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">createDataPartition</span>(bank<span class="sc">$</span>deposit, <span class="at">p =</span> <span class="fl">0.7</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>bank_train <span class="ot">&lt;-</span> bank[inTrain, ]</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>bank_test <span class="ot">&lt;-</span> bank[<span class="sc">-</span>inTrain, ]</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(bank_train<span class="sc">$</span>deposit)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  no yes </span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 560  73</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(bank_test<span class="sc">$</span>deposit)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  no yes </span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 240  31</span></span></code></pre></div>
<p>The training set and the testing set are both imbalanced and their
IRs are roughly the same as the whole dataset.</p>
<p>Now we apply Support Vector Machine (SVM) with Gaussian kernel on the
imbalanced training set and then predict the deposit status in the
testing set to check the classification performance.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2019</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>fit_orig <span class="ot">&lt;-</span> e1071<span class="sc">::</span><span class="fu">svm</span>(deposit <span class="sc">~</span> ., <span class="at">data =</span> bank_train, <span class="at">kernel =</span> <span class="st">&quot;radial&quot;</span>,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">probability=</span><span class="cn">TRUE</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>pred_class <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_orig, bank_test)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>perf_orig <span class="ot">&lt;-</span> <span class="fu">display</span>(pred_class, bank_test<span class="sc">$</span>deposit, <span class="at">positive=</span><span class="st">&quot;yes&quot;</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           Reference</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Prediction  no yes</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        no  236  31</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        yes   4   0</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(perf_orig, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Accuracy</th>
<th align="right">Sensitivity</th>
<th align="right">Specificity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.8708487</td>
<td align="right">0</td>
<td align="right">0.9833333</td>
</tr>
</tbody>
</table>
<p>According to the result, the accuracy of this model is realy high.
But all examples with “yes” (i.e., the minority samples) were classified
incorrectly so that sensitivity is 0. This performance is very bad.
There is a large space to improve it.</p>
<p>Then we use ROS, RUS, SBC and SMOTE-NC to balance it.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2019</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>train_ros <span class="ot">&lt;-</span> <span class="fu">ROS</span>(bank_train, <span class="st">&quot;deposit&quot;</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>train_rus <span class="ot">&lt;-</span> <span class="fu">RUS</span>(bank_train, <span class="st">&quot;deposit&quot;</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>train_sbc <span class="ot">&lt;-</span> <span class="fu">SBC</span>(bank_train, <span class="st">&quot;deposit&quot;</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>train_smotenc <span class="ot">&lt;-</span> <span class="fu">SMOTE_NC</span>(bank_train, <span class="st">&quot;deposit&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>fit_ros <span class="ot">&lt;-</span> e1071<span class="sc">::</span><span class="fu">svm</span>(deposit <span class="sc">~</span> ., <span class="at">data=</span>train_ros, <span class="at">kernel=</span><span class="st">&quot;radial&quot;</span>, <span class="at">probability=</span><span class="cn">TRUE</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>fit_rus <span class="ot">&lt;-</span> e1071<span class="sc">::</span><span class="fu">svm</span>(deposit <span class="sc">~</span> ., <span class="at">data=</span>train_rus, <span class="at">kernel=</span><span class="st">&quot;radial&quot;</span>, <span class="at">probability=</span><span class="cn">TRUE</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>fit_sbc <span class="ot">&lt;-</span> e1071<span class="sc">::</span><span class="fu">svm</span>(deposit <span class="sc">~</span> ., <span class="at">data=</span>train_sbc, <span class="at">kernel=</span><span class="st">&quot;radial&quot;</span>, <span class="at">probability=</span><span class="cn">TRUE</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>fit_smotenc <span class="ot">&lt;-</span> e1071<span class="sc">::</span><span class="fu">svm</span>(deposit <span class="sc">~</span> ., <span class="at">data=</span>train_smotenc, <span class="at">kernel=</span><span class="st">&quot;radial&quot;</span>, <span class="at">probability=</span><span class="cn">TRUE</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>pred_class_ros <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_ros, bank_test)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>perf_ros <span class="ot">&lt;-</span> <span class="fu">display</span>(pred_class_ros, bank_test<span class="sc">$</span>deposit, <span class="st">&quot;yes&quot;</span>)  </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           Reference</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Prediction  no yes</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        no  187  10</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        yes  53  21</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>pred_class_rus <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_rus, bank_test)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>perf_rus <span class="ot">&lt;-</span> <span class="fu">display</span>(pred_class_rus, bank_test<span class="sc">$</span>deposit, <span class="st">&quot;yes&quot;</span>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           Reference</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Prediction  no yes</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        no  182   8</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        yes  58  23</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>pred_class_sbc <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_sbc, bank_test)</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>perf_sbc <span class="ot">&lt;-</span> <span class="fu">display</span>(pred_class_sbc, bank_test<span class="sc">$</span>deposit, <span class="st">&quot;yes&quot;</span>)</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           Reference</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Prediction  no yes</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        no  134   5</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        yes 106  26</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>pred_class_smotenc <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_smotenc, bank_test)</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>perf_smotenc <span class="ot">&lt;-</span> <span class="fu">display</span>(pred_class_smotenc, bank_test<span class="sc">$</span>deposit, <span class="st">&quot;yes&quot;</span>)</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           Reference</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Prediction  no yes</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        no  195  14</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        yes  45  17</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">rbind</span>(perf_orig, perf_ros, perf_rus, perf_sbc, perf_smotenc)</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(output) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Imbalanced&quot;</span>, <span class="st">&quot;Balanced by ROS&quot;</span>, <span class="st">&quot;Balanced by RUS&quot;</span>,</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;Balanced by SBC&quot;</span>, <span class="st">&quot;Balanced by SMOTE-NC&quot;</span>)</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(output)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Accuracy</th>
<th align="right">Sensitivity</th>
<th align="right">Specificity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Imbalanced</td>
<td align="right">0.8708487</td>
<td align="right">0.0000000</td>
<td align="right">0.9833333</td>
</tr>
<tr class="even">
<td align="left">Balanced by ROS</td>
<td align="right">0.7675277</td>
<td align="right">0.6774194</td>
<td align="right">0.7791667</td>
</tr>
<tr class="odd">
<td align="left">Balanced by RUS</td>
<td align="right">0.7564576</td>
<td align="right">0.7419355</td>
<td align="right">0.7583333</td>
</tr>
<tr class="even">
<td align="left">Balanced by SBC</td>
<td align="right">0.5904059</td>
<td align="right">0.8387097</td>
<td align="right">0.5583333</td>
</tr>
<tr class="odd">
<td align="left">Balanced by SMOTE-NC</td>
<td align="right">0.7822878</td>
<td align="right">0.5483871</td>
<td align="right">0.8125000</td>
</tr>
</tbody>
</table>
<p>As we can see, all of these four algorithms helped to improve the
performance of random forest more or less. On the premise of ensuring a
good accuracy of a classifier, the sensitivity, which is highly related
to the minority class that we are more concerned, is improved by our
resampling strategies.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
